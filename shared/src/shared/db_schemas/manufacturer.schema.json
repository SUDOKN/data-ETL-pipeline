{
  "$jsonSchema": {
    "bsonType": "object",
    "required": [
      "etld1",
      "url_accessible_at",
      "created_at",
      "updated_at",
      "scraped_text_file_num_tokens",
      "scraped_text_file_version_id",
      "batches"
    ],
    "additionalProperties": false,
    "properties": {
      "_id": {
        "bsonType": "objectId"
      },
      "etld1": {
        "bsonType": "string",
        "description": "Effective top level domain plus + 1, 1 meaning domain, eg: example.com"
      },
      "url_accessible_at": {
        "bsonType": "string",
        "description": "Full URL with scheme that is pre-validated and pre-checked if it can be reached"
      },
      "created_at": {
        "bsonType": "date"
      },
      "updated_at": {
        "bsonType": "date"
      },
      "scraped_text_file_num_tokens": {
        "bsonType": "int"
      },
      "scraped_text_file_version_id": {
        "bsonType": "string",
        "minLength": 25
      },
      "batches": {
        "bsonType": "array",
        "minItems": 1,
        "items": {
          "bsonType": "object",
          "required": ["title", "timestamp"],
          "properties": {
            "title": {
              "bsonType": "string",
              "minLength": 1
            },
            "timestamp": {
              "bsonType": "date"
            }
          }
        }
      },
      "name": {
        "bsonType": ["string", "null"]
      },
      "is_manufacturer": {
        "bsonType": ["object", "null"],
        "required": ["evaluated_at", "answer", "confidence", "reason", "stats"],
        "properties": {
          "evaluated_at": {
            "bsonType": "date"
          },
          "name": {
            "bsonType": ["string", "null"]
          },
          "answer": {
            "bsonType": "bool"
          },
          "confidence": {
            "bsonType": "int"
          },
          "reason": {
            "bsonType": "string"
          },
          "stats": {
            "bsonType": "object",
            "required": [
              "prompt_version_id",
              "final_chunk_key",
              "chunk_result_map"
            ],
            "properties": {
              "prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "final_chunk_key": {
                "bsonType": "string",
                "minLength": 1
              },
              "chunk_result_map": {
                "bsonType": "object",
                "additionalProperties": {
                  "bsonType": "object",
                  "required": ["answer", "confidence", "reason"],
                  "properties": {
                    "answer": {
                      "bsonType": "bool"
                    },
                    "confidence": {
                      "bsonType": "int"
                    },
                    "reason": {
                      "bsonType": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "is_contract_manufacturer": {
        "bsonType": ["object", "null"],
        "required": ["evaluated_at", "answer", "confidence", "reason", "stats"],
        "properties": {
          "evaluated_at": {
            "bsonType": "date"
          },
          "answer": {
            "bsonType": "bool"
          },
          "confidence": {
            "bsonType": "int"
          },
          "reason": {
            "bsonType": "string"
          },
          "stats": {
            "bsonType": "object",
            "required": [
              "prompt_version_id",
              "final_chunk_key",
              "chunk_result_map"
            ],
            "properties": {
              "prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "final_chunk_key": {
                "bsonType": "string",
                "minLength": 1
              },
              "chunk_result_map": {
                "bsonType": "object",
                "additionalProperties": {
                  "bsonType": "object",
                  "required": ["answer", "confidence", "reason"],
                  "properties": {
                    "answer": {
                      "bsonType": "bool"
                    },
                    "confidence": {
                      "bsonType": "int"
                    },
                    "reason": {
                      "bsonType": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "is_product_manufacturer": {
        "bsonType": ["object", "null"],
        "required": ["evaluated_at", "answer", "confidence", "reason", "stats"],
        "properties": {
          "evaluated_at": {
            "bsonType": "date"
          },
          "answer": {
            "bsonType": "bool"
          },
          "confidence": {
            "bsonType": "int"
          },
          "reason": {
            "bsonType": "string"
          },
          "stats": {
            "bsonType": "object",
            "required": [
              "prompt_version_id",
              "final_chunk_key",
              "chunk_result_map"
            ],
            "properties": {
              "prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "final_chunk_key": {
                "bsonType": "string",
                "minLength": 1
              },
              "chunk_result_map": {
                "bsonType": "object",
                "additionalProperties": {
                  "bsonType": "object",
                  "required": ["answer", "confidence", "reason"],
                  "properties": {
                    "answer": {
                      "bsonType": "bool"
                    },
                    "confidence": {
                      "bsonType": "int"
                    },
                    "reason": {
                      "bsonType": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "founded_in": {
        "bsonType": ["int", "null"],
        "minimum": 1800
      },
      "num_employees": {
        "bsonType": ["int", "null"]
      },
      "business_desc": {
        "bsonType": ["string", "null"]
      },
      "business_statuses": {
        "bsonType": ["array", "null"],
        "items": {
          "bsonType": "string",
          "minLength": 1
        },
        "uniqueItems": true
      },
      "primary_naics": {
        "bsonType": ["string", "null"]
      },
      "secondary_naics": {
        "bsonType": ["array", "null"],
        "items": {
          "bsonType": "string",
          "minLength": 5
        },
        "uniqueItems": true
      },
      "addresses": {
        "bsonType": ["array", "null"],
        "items": {
          "bsonType": "object",
          "required": [
            "line_1",
            "city",
            "county",
            "state",
            "zip",
            "latitude",
            "longitude"
          ],
          "properties": {
            "line_1": {
              "bsonType": "string"
            },
            "city": {
              "bsonType": "string"
            },
            "county": {
              "bsonType": "string"
            },
            "state": {
              "bsonType": "string",
              "minLength": 2
            },
            "zip": {
              "bsonType": "string",
              "minLength": 5
            },
            "latitude": {
              "bsonType": "double"
            },
            "longitude": {
              "bsonType": "double"
            },
            "phone_num": {
              "bsonType": ["string", "null"]
            },
            "fax_num": {
              "bsonType": ["string", "null"]
            }
          }
        }
      },
      "products": {
        "bsonType": ["object", "null"],
        "required": ["extracted_at", "results", "stats"],
        "properties": {
          "extracted_at": {
            "bsonType": "date"
          },
          "results": {
            "bsonType": "array",
            "uniqueItems": true,
            "items": {
              "bsonType": "string",
              "minLength": 1
            }
          },
          "stats": {
            "bsonType": "object",
            "required": ["extract_prompt_version_id", "search"],
            "additionalProperties": false,
            "properties": {
              "extract_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "search": {
                "bsonType": "object",
                "patternProperties": {
                  "^[0-9]+:[0-9]+$": {
                    "bsonType": "array",
                    "uniqueItems": true,
                    "items": {
                      "bsonType": "string",
                      "minLength": 1
                    }
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "additionalProperties": false
      },
      "certificates": {
        "bsonType": ["object", "null"],
        "required": ["extracted_at", "results", "stats"],
        "properties": {
          "extracted_at": {
            "bsonType": "date"
          },
          "results": {
            "bsonType": "array",
            "uniqueItems": true,
            "items": {
              "bsonType": "string",
              "minLength": 1
            }
          },
          "stats": {
            "bsonType": "object",
            "required": [
              "extract_prompt_version_id",
              "map_prompt_version_id",
              "ontology_version_id",
              "mapping",
              "search",
              "unmapped_llm"
            ],
            "additionalProperties": false,
            "properties": {
              "extract_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "map_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "ontology_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "mapping": {
                "bsonType": "object",
                "additionalProperties": {
                  "bsonType": "array",
                  "uniqueItems": true,
                  "items": {
                    "bsonType": "string",
                    "minLength": 1
                  }
                }
              },
              "search": {
                "bsonType": "object",
                "patternProperties": {
                  "^[0-9]+:[0-9]+$": {
                    "bsonType": "object",
                    "required": [
                      "results",
                      "brute",
                      "llm",
                      "mapping",
                      "unmapped_llm"
                    ],
                    "additionalProperties": false,
                    "properties": {
                      "results": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "brute": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "mapping": {
                        "bsonType": "object",
                        "additionalProperties": {
                          "bsonType": "array",
                          "uniqueItems": true,
                          "items": {
                            "bsonType": "string",
                            "minLength": 1
                          }
                        }
                      },
                      "unmapped_llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      }
                    }
                  }
                },
                "additionalProperties": false
              },
              "unmapped_llm": {
                "bsonType": "array",
                "uniqueItems": true,
                "items": {
                  "bsonType": "string",
                  "minLength": 1
                }
              }
            }
          }
        },
        "additionalProperties": false
      },
      "industries": {
        "bsonType": ["object", "null"],
        "required": ["extracted_at", "results", "stats"],
        "properties": {
          "extracted_at": {
            "bsonType": "date"
          },
          "results": {
            "bsonType": "array",
            "uniqueItems": true,
            "items": {
              "bsonType": "string",
              "minLength": 1
            }
          },
          "stats": {
            "bsonType": "object",
            "required": [
              "extract_prompt_version_id",
              "map_prompt_version_id",
              "ontology_version_id",
              "mapping",
              "search",
              "unmapped_llm"
            ],
            "additionalProperties": false,
            "properties": {
              "extract_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "map_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "ontology_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "mapping": {
                "bsonType": "object",
                "additionalProperties": {
                  "bsonType": "array",
                  "uniqueItems": true,
                  "items": {
                    "bsonType": "string",
                    "minLength": 1
                  }
                }
              },
              "search": {
                "bsonType": "object",
                "patternProperties": {
                  "^[0-9]+:[0-9]+$": {
                    "bsonType": "object",
                    "required": [
                      "results",
                      "brute",
                      "llm",
                      "mapping",
                      "unmapped_llm"
                    ],
                    "additionalProperties": false,
                    "properties": {
                      "results": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "brute": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "mapping": {
                        "bsonType": "object",
                        "additionalProperties": {
                          "bsonType": "array",
                          "uniqueItems": true,
                          "items": {
                            "bsonType": "string",
                            "minLength": 1
                          }
                        }
                      },
                      "unmapped_llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      }
                    }
                  }
                },
                "additionalProperties": false
              },
              "unmapped_llm": {
                "bsonType": "array",
                "uniqueItems": true,
                "items": {
                  "bsonType": "string",
                  "minLength": 1
                }
              }
            }
          }
        },
        "additionalProperties": false
      },
      "process_caps": {
        "bsonType": ["object", "null"],
        "required": ["extracted_at", "results", "stats"],
        "properties": {
          "extracted_at": {
            "bsonType": "date"
          },
          "results": {
            "bsonType": "array",
            "uniqueItems": true,
            "items": {
              "bsonType": "string",
              "minLength": 1
            }
          },
          "stats": {
            "bsonType": "object",
            "required": [
              "extract_prompt_version_id",
              "map_prompt_version_id",
              "ontology_version_id",
              "mapping",
              "search",
              "unmapped_llm"
            ],
            "additionalProperties": false,
            "properties": {
              "extract_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "map_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "ontology_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "mapping": {
                "bsonType": "object",
                "additionalProperties": {
                  "bsonType": "array",
                  "uniqueItems": true,
                  "items": {
                    "bsonType": "string",
                    "minLength": 1
                  }
                }
              },
              "search": {
                "bsonType": "object",
                "patternProperties": {
                  "^[0-9]+:[0-9]+$": {
                    "bsonType": "object",
                    "required": [
                      "results",
                      "brute",
                      "llm",
                      "mapping",
                      "unmapped_llm"
                    ],
                    "additionalProperties": false,
                    "properties": {
                      "results": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "brute": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "mapping": {
                        "bsonType": "object",
                        "additionalProperties": {
                          "bsonType": "array",
                          "uniqueItems": true,
                          "items": {
                            "bsonType": "string",
                            "minLength": 1
                          }
                        }
                      },
                      "unmapped_llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      }
                    }
                  }
                },
                "additionalProperties": false
              },
              "unmapped_llm": {
                "bsonType": "array",
                "uniqueItems": true,
                "items": {
                  "bsonType": "string",
                  "minLength": 1
                }
              }
            }
          }
        },
        "additionalProperties": false
      },
      "material_caps": {
        "bsonType": ["object", "null"],
        "required": ["extracted_at", "results", "stats"],
        "properties": {
          "extracted_at": {
            "bsonType": "date"
          },
          "results": {
            "bsonType": "array",
            "uniqueItems": true,
            "items": {
              "bsonType": "string",
              "minLength": 1
            }
          },
          "stats": {
            "bsonType": "object",
            "required": [
              "extract_prompt_version_id",
              "map_prompt_version_id",
              "ontology_version_id",
              "mapping",
              "search",
              "unmapped_llm"
            ],
            "additionalProperties": false,
            "properties": {
              "extract_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "map_prompt_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "ontology_version_id": {
                "bsonType": "string",
                "minLength": 1
              },
              "mapping": {
                "bsonType": "object",
                "additionalProperties": {
                  "bsonType": "array",
                  "uniqueItems": true,
                  "items": {
                    "bsonType": "string",
                    "minLength": 1
                  }
                }
              },
              "search": {
                "bsonType": "object",
                "patternProperties": {
                  "^[0-9]+:[0-9]+$": {
                    "bsonType": "object",
                    "required": [
                      "results",
                      "brute",
                      "llm",
                      "mapping",
                      "unmapped_llm"
                    ],
                    "additionalProperties": false,
                    "properties": {
                      "results": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "brute": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      },
                      "mapping": {
                        "bsonType": "object",
                        "additionalProperties": {
                          "bsonType": "array",
                          "uniqueItems": true,
                          "items": {
                            "bsonType": "string",
                            "minLength": 1
                          }
                        }
                      },
                      "unmapped_llm": {
                        "bsonType": "array",
                        "uniqueItems": true,
                        "items": {
                          "bsonType": "string",
                          "minLength": 1
                        }
                      }
                    }
                  }
                },
                "additionalProperties": false
              },
              "unmapped_llm": {
                "bsonType": "array",
                "uniqueItems": true,
                "items": {
                  "bsonType": "string",
                  "minLength": 1
                }
              }
            }
          }
        },
        "additionalProperties": false
      }
    }
  }
}
